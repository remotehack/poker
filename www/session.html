<html>

<head>
    <title>🃏</title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <h1>🃏 Session!!!!</h1>

    <div id="out"></div>

    <script>
        const WSURL = new URL(document.location)

        WSURL.protocol = WSURL.protocol === 'https:' ? 'wss:' : 'ws:'
        const ws = new WebSocket(WSURL)

        ws.addEventListener("message", (e) => {
            out.innerHTML = renderHTML(e.data)
        })

        function clearScores() {
            ws.send(JSON.stringify({ clearScores: true }));
        }

        function renderHTML(data) {
            data = JSON.parse(data);

            html = '<ul>';
            for (participant in data.participants) {
                html += '<li>';

                html += data.participants[participant] + ': ';

                if (undefined !== data.scores[participant]) {
                    html += data.scores[participant]
                }

                html += '</li>';

            }

            html += '</ul>';

            return html
        }

    </script>
    <button onclick="clearScores()">Clear scores.</button>
</body>

</html>
